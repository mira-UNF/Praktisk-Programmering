# Compiler
CXX = mcs
# Executable name
EXEC = main.exe
# C# source file
SRC = main.cs

# Data files generated by the program
ERF_SMOOTH = erf_smooth_curve.txt
ERF_POINTS = erf_tabulated_points.txt

GAMMA_SMOOTH = gamma_smooth_curve.txt
GAMMA_POINTS = gamma_tabulated_points.txt

LNGAMMA_SMOOTH = lngamma_smooth_curve.txt
LNGAMMA_POINTS = lngamma_tabulated_points.txt

# Output plot files
ERF_PNG = erf_plot.png
GAMMA_PNG = gamma_plot.png
LNGAMMA_PNG = lngamma_plot.png

# Default target: Generate all plots
all: $(ERF_PNG) $(GAMMA_PNG) $(LNGAMMA_PNG)

# Run the program to generate output text files
$(ERF_SMOOTH) $(ERF_POINTS) $(GAMMA_SMOOTH) $(GAMMA_POINTS) $(LNGAMMA_SMOOTH) $(LNGAMMA_POINTS): $(EXEC)
	mono $(EXEC)

# Compile the C# program
$(EXEC): $(SRC)
	mcs $(SRC)

# Generate erf plot
$(ERF_PNG): $(ERF_SMOOTH) $(ERF_POINTS) $(EXEC)
	# Ensure the files exist and display the contents for debugging
	@if [ ! -f $(ERF_SMOOTH) ]; then echo "Error: $(ERF_SMOOTH) not found"; exit 1; fi
	@if [ ! -f $(ERF_POINTS) ]; then echo "Error: $(ERF_POINTS) not found"; exit 1; fi
	# Plotting for erf
	graph -T png -x 0 1.2 -y 0 1.2 --bitmap-size 800x600 \
		-S 1 $(ERF_SMOOTH) \
		-S 2 $(ERF_POINTS) -m 1 \
		> $(ERF_PNG)
	echo "ERF Plot saved to $(ERF_PNG)"

# Generate gamma plot
$(GAMMA_PNG): $(GAMMA_SMOOTH) $(GAMMA_POINTS) $(EXEC)
	# Ensure the files exist and display the contents for debugging
	@if [ ! -f $(GAMMA_SMOOTH) ]; then echo "Error: $(GAMMA_SMOOTH) not found"; exit 1; fi
	@if [ ! -f $(GAMMA_POINTS) ]; then echo "Error: $(GAMMA_POINTS) not found"; exit 1; fi
	# Plotting for gamma
	graph -T png -x 0 1.2  -y 0 100 --bitmap-size 800x600 \
		-S 1 $(GAMMA_SMOOTH) \
		-S 2 $(GAMMA_POINTS) -m 1 \
		> $(GAMMA_PNG)
	echo "Gamma Plot saved to $(GAMMA_PNG)"

# Generate lngamma plot
$(LNGAMMA_PNG): $(LNGAMMA_SMOOTH) $(LNGAMMA_POINTS) $(EXEC)
	# Ensure the files exist and display the contents for debugging
	@if [ ! -f $(LNGAMMA_SMOOTH) ]; then echo "Error: $(LNGAMMA_SMOOTH) not found"; exit 1; fi
	@if [ ! -f $(LNGAMMA_POINTS) ]; then echo "Error: $(LNGAMMA_POINTS) not found"; exit 1; fi
	# Plotting for lngamma
	graph -T png -x 0 1.2 -y 0 10 --bitmap-size 800x600 \
		-S 1 $(LNGAMMA_SMOOTH) \
		-S 2 $(LNGAMMA_POINTS) -m 1 \
		> $(LNGAMMA_PNG)
	echo "Lngamma Plot saved to $(LNGAMMA_PNG)"

# Clean build artifacts
.PHONY: clean
clean:
	rm -f $(EXEC) $(ERF_PNG) $(GAMMA_PNG) $(LNGAMMA_PNG) $(ERF_SMOOTH) $(ERF_POINTS) $(GAMMA_SMOOTH) $(GAMMA_POINTS) $(LNGAMMA_SMOOTH) $(LNGAMMA_POINTS) Out.txt
